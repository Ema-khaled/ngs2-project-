conda activate ngs1

#download data for the third sample 
mkdir -p ~/sample3_data && cd ~/sample3_data
wget https://sra-downloadb.be-md.ncbi.nlm.nih.gov/sos1/sra-pub-run-1/SRR8241116/SRR8241116.1	

# after dwanloaded the data, i couldn't open it so i used sra-toolkit to solve this problem
conda install -c bioconda sra-tools
#convert data format from sra to fastq 
 fastq-dump -I --split-files --gzip SRR8241116.1
# Produces two fastq files (--split-files) containing ".1" and ".2" read suffices (-I) for paired-end data

#check the quality of the data "fastaQC" using fastqc& multiqc tools 
  cd ~/sample3_data
conda install -c bioconda fastqc 
for f in ~/sample3_data/*.fastq.gz;do fastqc -t 1 -f fastq -noextract $f;done

#multiqc report 
conda install -c bioconda multiqc 
mv ../sample3_data/*html ./
mv ../sample3_data/*zip ./
multiqc -z -o . .

#triming for increase the quality of the data using trimmomatic tool
conda install -c bioconda trimmomatic 
mkdir -p ~/ngs2project/trimmed3 && cd ~/ngs2project/trimmed3 

#Dwanload referance "chro17"
mkdir -p ~/ngs2project/genomref && cd ~/ngs2project/genomref
wget ftp://ftp.ensembl.org/pub/release-99/fasta/homo_sapiens/cds/Homo_sapiens.GRCh38.cds.all.fa.gz

#genome indexing to spead up the alinment process
mkdir -p ~/ngs2project/bwa_align/bwaIndex && cd ~/ngs2project/bwa_align/bwaIndex
ln -s ~/ngs2project/genomref/dog_chr5.fa .
bwa index -a bwtsw dog_chr5.fa

#sequance alignment using BWA
cd ~/workdir/bwa_align
R1="$HOME/ngs2project/fqData3/BD143_TGACCA_L005_R1_001.pe.fq.gz"
R2="$HOME/ngs2project/fqData3/BD143_TGACCA_L005_R2_001.pe.fq.gz"
/usr/bin/time -v bwa mem bwaIndex/dog_chr5.fa $R1 $R2 > BD143_TGACCA_L005.sam

#convert SAM to BAM file using samtools
conda install -y samtools
samtools view -S -b BD143_TGACCA_L005.sam -o BD143_TGACCA_L005.bam

# Sorting the BAM file
samtools sort BD143_TGACCA_L005.bam -o sorted_BD143_TGACCA_L005.bam

# Indexing the BAM file
samtools index sorted_BD143_TGACCA_L005.bam
#generate PseudoBAM






